<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Card√°pio do dia - Sabor do Tempero">
  <meta name="theme-color" content="#C99548">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Sabor do Tempero">

  <title>Sabor do Tempero - Card√°pio do Dia</title>

  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" href="/assets/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
  <header class="header header-video">
    <!-- V√≠deo de fundo -->
    <div class="header-bg">
      <video
        class="header-video-el"
        src="header.mp4"
        poster=""
        autoplay
        muted
        loop
        playsinline
      ></video>
      <div class="header-overlay" aria-hidden="true"></div>
    </div>

    <!-- Conte√∫do do header -->
    <div class="container header-row">
      <a href="/" class="brand" aria-label="In√≠cio">
        <img src="logo.png" alt="Sabor do Tempero" class="logo" id="logo">
      </a>
    </div>
  </header>

  <!-- AVISO CHAMATIVO de desconto -->
  <aside class="promo-banner" role="note" aria-live="polite" id="promoBanner">
    <div class="promo-wrap">
      <div class="promo-text">
        <span aria-hidden="true">üéâ</span>
        <span>
          <strong>Promo√ß√£o:</strong> pedidos feitos pelo site usando o bot√£o de <strong>WhatsApp</strong> abaixo t√™m
          <strong>10% de desconto</strong>!
        </span>
      </div>
      <div style="display:flex; align-items:center; gap:.5rem;">
        <a href="#btnWhatsApp" class="promo-link" aria-label="Ir para o bot√£o de WhatsApp e garantir 10% de desconto">
          <span>Quero meu desconto</span>
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 12h14M13 5l7 7-7 7" fill="none" stroke="currentColor" stroke-width="2"/>
          </svg>
        </a>
        <button class="promo-close" id="promoClose" aria-label="Fechar aviso de promo√ß√£o">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6 6l12 12M18 6L6 18" fill="none" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
    </div>
  </aside>

  <main class="main">
    <div class="container">
      <h1 class="titulo-dia" id="tituloDia">Card√°pio do Dia</h1>
      <p class="data-dia" id="dataDia"></p>
      <p class="info-taxas">
        üçΩÔ∏è Prato individual a partir de <strong>R$ 25,00</strong><br>
        üöö Entrega gratuita para <strong>Rio Quente</strong> e taxa de <strong>R$ 5,00</strong> para <strong>Esplanada</strong>.
      </p><br>

      <div id="offlineAlert" class="alert alert-warning" style="display: none;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        Voc√™ est√° offline. Mostrando √∫ltimo card√°pio salvo.
      </div>

      <section class="cardapio" id="cardapio">
        <div class="loading" id="loading">
          <div class="spinner"></div>
          <p>Carregando card√°pio...</p>
        </div>

        <!-- FEED (posts estilo Instagram) -->
        <div id="feed" class="feed" aria-live="polite" hidden></div>
      </section>
    </div>
  </main>

  <div class="container cta-buttons">
    <a id="btnWhatsApp" class="btn btn-whatsapp" href="#" rel="noopener">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"> ... </svg>
      Fazer Pedido no WhatsApp (10% OFF)
    </a>

    <!-- NOVO: bot√£o Instagram -->
    <a id="btnInstagram"
      class="btn btn-instagram"
      href="https://instagram.com/sabordotempero_marmitaria"
      target="_blank"
      rel="noopener"
      aria-label="Abrir Instagram do Sabor do Tempero">
      <!-- √çcone Instagram (SVG) -->
      <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
        <path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.51 5.51 0 0 1 12 7.5zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5zM18 6.75a1.25 1.25 0 1 1-1.25 1.25A1.25 1.25 0 0 1 18 6.75z"/>
      </svg>
      Siga no Instagram
    </a>
  </div>

  <!-- MODAL DE PEDIDO COMPLETO -->
  <div id="orderModal" class="ord-modal" aria-hidden="true" role="dialog" aria-label="Finalizar pedido">
    <div class="ord-backdrop" data-close="1"></div>
    <div class="ord-card" role="document">
      <header class="ord-header">
        <h3 class="ord-title">Finalizar pedido</h3>
        <button class="ord-close" id="ordClose" aria-label="Fechar">‚úï</button>
      </header>

      <form id="ordForm" class="ord-form">
        <!-- Dados do cliente -->
        <fieldset class="ord-fieldset">
          <legend>Seus dados</legend>
          <div class="ord-grid">
            <label class="ord-lab">
              Nome
              <input required id="cliNome" name="cliNome" placeholder="Seu nome completo">
            </label>
            <label class="ord-lab">
              WhatsApp
              <input required id="cliFone" name="cliFone" inputmode="tel" placeholder="(62) 9 0000-0000">
            </label>
            <label class="ord-lab ord-col2">
              Endere√ßo (rua, n√∫mero, complemento)
              <input required id="cliEndereco" name="cliEndereco" placeholder="Rua, n¬∫, complemento">
            </label>
          </div>
        </fieldset>

        <!-- Local de entrega -->
        <fieldset class="ord-fieldset">
          <legend>Local de entrega</legend>
          <div class="ord-radio-row">
            <label class="ord-radio">
              <input type="radio" name="cliLocal" value="rio-quente" checked>
              <span>Rio Quente <small>(entrega gr√°tis)</small></span>
            </label>
            <label class="ord-radio">
              <input type="radio" name="cliLocal" value="esplanada">
              <span>Esplanada <small>(taxa R$ 5,00)</small></span>
            </label>
          </div>
        </fieldset>

        <!-- Itens do pedido -->
        <fieldset class="ord-fieldset">
          <legend>Itens</legend>

          <div id="ordItems"></div>

          <button type="button" class="ord-add" id="ordAddItem">+ Adicionar item</button>
        </fieldset>

        <!-- Observa√ß√µes -->
        <label class="ord-lab ord-col2">
          Observa√ß√µes
          <textarea id="cliObs" rows="2" placeholder="Ex.: sem pimenta, trocar feij√£o por salada..."></textarea>
        </label>

        <!-- Totais -->
        <div class="ord-totais">
          <div class="ord-row">
            <span>Subtotal</span>
            <strong id="tSub">R$ 0,00</strong>
          </div>
          <div class="ord-row desc">
            <span>Desconto do site (10%)</span>
            <strong id="tDesc">- R$ 0,00</strong>
          </div>
          <div class="ord-row">
            <span>Entrega</span>
            <strong id="tFrete">R$ 0,00</strong>
          </div>
          <div class="ord-row grand">
            <span>Total</span>
            <strong id="tTotal">R$ 0,00</strong>
          </div>
        </div>

        <footer class="ord-footer">
          <button type="button" class="btn btn-secondary" id="ordCancel">Cancelar</button>
          <button type="submit" class="btn btn-whatsapp" id="ordSubmit">
            Enviar no WhatsApp (10% OFF)
          </button>
        </footer>
      </form>
    </div>
  </div>


  <section class="sobre" id="secaoSobre">
    <div class="container">
      <h2 class="sobre-titulo">Sobre</h2>

      <div class="sobre-conteudo sobre-coluna">
        <figure class="sobre-fig">
          <img
            src="dona_fatima.png"
            alt="Dona F√°tima, chef e fundadora do Sabor do Tempero"
            class="sobre-foto"
            width="320"
            height="320"
            loading="lazy"
            decoding="async"
          >
          <figcaption class="sr-only">Dona F√°tima, chef e fundadora</figcaption>
        </figure>

        <div class="sobre-texto">
          <p class="sobre-nome" id="sobreNome"></p>
          <div class="sobre-info" id="sobreInfo"></div>
        </div>
      </div>
    </div>
  </section>

<footer class="footer">
  <div class="container">
    <p class="footer-text">
      ¬© 2025 Sabor do Tempero ¬∑ Feito com amor 
      <span style="color: #e25555;">‚ù§Ô∏è</span> 
      por <a href="https://henriquesilva.dev" target="_blank" rel="noopener noreferrer">Henrique Silva Dev</a>
    </p>
  </div>
</footer>

  <script src="/env.js"></script>
  <script type="module" src="/scripts/firebase-init.mjs"></script>
  <script src="/scripts/app.js"></script>
  <script src="/scripts/tts.js"></script>
  <script type="module" src="/src/main.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/scripts/sw.js')
          .then(reg => console.log('Service Worker registrado:', reg))
          .catch(err => console.log('Erro ao registrar Service Worker:', err));
      });
    }

    import { initializeApp } from "firebase/app";
    import {
      getAuth, signInAnonymously, onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
    import {
      getFirestore, doc, collection, onSnapshot, setDoc, deleteDoc, serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: process.env.VITE_FIREBASE_API_KEY,
      authDomain: process.env.VITE_FIREBASE_AUTH_DOMAIN,
      projectId: process.env.VITE_FIREBASE_PROJECT_ID,
      storageBucket: process.env.VITE_FIREBASE_STORAGE_BUCKET,
      messagingSenderId: process.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
      appId: process.env.VITE_FIREBASE_APP_ID,
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    // login an√¥nimo garantido
    await signInAnonymously(auth);
    let currentUid = null;
    onAuthStateChanged(auth, (u) => { currentUid = u?.uid || null; });

    // torna acess√≠vel no seu app.js
    window.__fb = { db, auth, onSnapshot, doc, collection, setDoc, deleteDoc, serverTimestamp, get uid(){return currentUid;} };
  </script>
</body>
</html>
